A new study created in memory with name: no-name-ae2db193-4968-4982-8510-71b61f5c06e0
Trial 0 finished with value: 0.20735012755102042 and parameters: {'lr': 0.0001849429235906087, 'dropout': 0.2650703332077242, 'patch_size': 8, 'embed_dim': 192, 'depth': 2, 'n_heads': 2, 'mlp_ratio': 4, 'mix_ratio': 0.3324094090990545}. Best is trial 0 with value: 0.20735012755102042.
Trial 1 finished with value: 0.27830038265306123 and parameters: {'lr': 0.0005163439686344045, 'dropout': 0.22229114775740874, 'patch_size': 8, 'embed_dim': 384, 'depth': 5, 'n_heads': 3, 'mlp_ratio': 2, 'mix_ratio': 0.4906988906593821}. Best is trial 1 with value: 0.27830038265306123.
Trial 2 finished with value: 0.31058673469387754 and parameters: {'lr': 0.00022960748247258448, 'dropout': 0.2101406314258085, 'patch_size': 16, 'embed_dim': 768, 'depth': 2, 'n_heads': 8, 'mlp_ratio': 2, 'mix_ratio': 0.5132331571843298}. Best is trial 2 with value: 0.31058673469387754.
Trial 3 finished with value: 0.07055165816326531 and parameters: {'lr': 1.0298415285002167e-05, 'dropout': 0.29775166845855583, 'patch_size': 8, 'embed_dim': 384, 'depth': 6, 'n_heads': 8, 'mlp_ratio': 3, 'mix_ratio': 0.2838571903629808}. Best is trial 2 with value: 0.31058673469387754.
Trial 4 finished with value: 0.2627551020408163 and parameters: {'lr': 0.0001245012318168794, 'dropout': 0.4006387488737593, 'patch_size': 8, 'embed_dim': 768, 'depth': 4, 'n_heads': 4, 'mlp_ratio': 2, 'mix_ratio': 0.34279414677468856}. Best is trial 2 with value: 0.31058673469387754.
Trial 5 finished with value: 0.2110969387755102 and parameters: {'lr': 2.5357460416850277e-05, 'dropout': 0.2347442400457377, 'patch_size': 8, 'embed_dim': 576, 'depth': 5, 'n_heads': 4, 'mlp_ratio': 3, 'mix_ratio': 0.4044994298922665}. Best is trial 2 with value: 0.31058673469387754.
Trial 6 finished with value: 0.18925382653061223 and parameters: {'lr': 0.0005318219517646807, 'dropout': 0.4548818354319879, 'patch_size': 16, 'embed_dim': 192, 'depth': 4, 'n_heads': 2, 'mlp_ratio': 2, 'mix_ratio': 0.33581106956001633}. Best is trial 2 with value: 0.31058673469387754.
Trial 7 finished with value: 0.07633131377551021 and parameters: {'lr': 1.6785713945779533e-05, 'dropout': 0.243006786885376, 'patch_size': 8, 'embed_dim': 192, 'depth': 5, 'n_heads': 2, 'mlp_ratio': 3, 'mix_ratio': 0.39582029437167615}. Best is trial 2 with value: 0.31058673469387754.
Trial 8 finished with value: 0.17637914540816327 and parameters: {'lr': 0.000567778724305109, 'dropout': 0.34366523567348095, 'patch_size': 32, 'embed_dim': 192, 'depth': 4, 'n_heads': 2, 'mlp_ratio': 4, 'mix_ratio': 0.35239524323845345}. Best is trial 2 with value: 0.31058673469387754.
Trial 9 finished with value: 0.19997608418367346 and parameters: {'lr': 5.225597611564537e-05, 'dropout': 0.2931001325689344, 'patch_size': 16, 'embed_dim': 384, 'depth': 4, 'n_heads': 3, 'mlp_ratio': 2, 'mix_ratio': 0.2403838575875331}. Best is trial 2 with value: 0.31058673469387754.
Trial 10 finished with value: 0.3062021683673469 and parameters: {'lr': 0.00022583462150363136, 'dropout': 0.138211504483771, 'patch_size': 16, 'embed_dim': 768, 'depth': 2, 'n_heads': 6, 'mlp_ratio': 2, 'mix_ratio': 0.5930664196432861}. Best is trial 2 with value: 0.31058673469387754.
Trial 11 finished with value: 0.31935586734693877 and parameters: {'lr': 0.00020711512664770986, 'dropout': 0.10756098630939148, 'patch_size': 16, 'embed_dim': 768, 'depth': 2, 'n_heads': 6, 'mlp_ratio': 2, 'mix_ratio': 0.5937546344158531}. Best is trial 11 with value: 0.31935586734693877.
Trial 12 finished with value: 0.30349170918367346 and parameters: {'lr': 7.230591961021969e-05, 'dropout': 0.10330373114010324, 'patch_size': 16, 'embed_dim': 768, 'depth': 2, 'n_heads': 6, 'mlp_ratio': 2, 'mix_ratio': 0.5934578445307658}. Best is trial 11 with value: 0.31935586734693877.
Trial 13 finished with value: 0.3079161352040816 and parameters: {'lr': 0.00023603883817627854, 'dropout': 0.16907469866132196, 'patch_size': 16, 'embed_dim': 768, 'depth': 3, 'n_heads': 8, 'mlp_ratio': 2, 'mix_ratio': 0.5161899436534115}. Best is trial 11 with value: 0.31935586734693877.
Trial 14 finished with value: 0.06744260204081633 and parameters: {'lr': 0.0009148193119152476, 'dropout': 0.17593633427980804, 'patch_size': 32, 'embed_dim': 768, 'depth': 3, 'n_heads': 8, 'mlp_ratio': 4, 'mix_ratio': 0.5067030873320855}. Best is trial 11 with value: 0.31935586734693877.
Trial 15 finished with value: 0.32473692602040816 and parameters: {'lr': 0.00011822965102633024, 'dropout': 0.10618131900085569, 'patch_size': 16, 'embed_dim': 576, 'depth': 3, 'n_heads': 6, 'mlp_ratio': 2, 'mix_ratio': 0.5454051108385581}. Best is trial 15 with value: 0.32473692602040816.
Trial 16 finished with value: 0.2674186862244898 and parameters: {'lr': 4.5381785281153795e-05, 'dropout': 0.10119346119590218, 'patch_size': 16, 'embed_dim': 576, 'depth': 3, 'n_heads': 6, 'mlp_ratio': 2, 'mix_ratio': 0.5599414537342138}. Best is trial 15 with value: 0.32473692602040816.
Trial 17 finished with value: 0.2321827168367347 and parameters: {'lr': 0.00011293572573956046, 'dropout': 0.15734511928211886, 'patch_size': 32, 'embed_dim': 576, 'depth': 3, 'n_heads': 6, 'mlp_ratio': 2, 'mix_ratio': 0.47751432632544855}. Best is trial 15 with value: 0.32473692602040816.
Trial 18 finished with value: 0.22165975765306123 and parameters: {'lr': 7.353121497874238e-05, 'dropout': 0.3533679032099293, 'patch_size': 16, 'embed_dim': 576, 'depth': 3, 'n_heads': 6, 'mlp_ratio': 3, 'mix_ratio': 0.4340474468911055}. Best is trial 15 with value: 0.32473692602040816.
Trial 19 finished with value: 0.3016980229591837 and parameters: {'lr': 0.0003208223478910928, 'dropout': 0.13465806274373626, 'patch_size': 16, 'embed_dim': 576, 'depth': 2, 'n_heads': 6, 'mlp_ratio': 4, 'mix_ratio': 0.5476754514934775}. Best is trial 15 with value: 0.32473692602040816.
Trial 20 finished with value: 0.3068797831632653 and parameters: {'lr': 0.00013370950040564246, 'dropout': 0.19042544766569305, 'patch_size': 16, 'embed_dim': 576, 'depth': 3, 'n_heads': 6, 'mlp_ratio': 2, 'mix_ratio': 0.4635061230850908}. Best is trial 15 with value: 0.32473692602040816.
Trial 21 finished with value: 0.29958545918367346 and parameters: {'lr': 0.00035233122579163924, 'dropout': 0.20534191289242962, 'patch_size': 16, 'embed_dim': 768, 'depth': 2, 'n_heads': 8, 'mlp_ratio': 2, 'mix_ratio': 0.5327517615979134}. Best is trial 15 with value: 0.32473692602040816.
Trial 22 finished with value: 0.3107063137755102 and parameters: {'lr': 0.0001899993666872323, 'dropout': 0.13040103487494092, 'patch_size': 16, 'embed_dim': 768, 'depth': 2, 'n_heads': 8, 'mlp_ratio': 2, 'mix_ratio': 0.5667438571127399}. Best is trial 15 with value: 0.32473692602040816.
Trial 23 finished with value: 0.3166454081632653 and parameters: {'lr': 0.000158165072840699, 'dropout': 0.11792075261871132, 'patch_size': 16, 'embed_dim': 768, 'depth': 2, 'n_heads': 6, 'mlp_ratio': 2, 'mix_ratio': 0.5637898210709873}. Best is trial 15 with value: 0.32473692602040816.
Trial 24 finished with value: 0.33434311224489793 and parameters: {'lr': 7.418334923817221e-05, 'dropout': 0.10092184375027781, 'patch_size': 16, 'embed_dim': 768, 'depth': 3, 'n_heads': 6, 'mlp_ratio': 2, 'mix_ratio': 0.5964552204766896}. Best is trial 24 with value: 0.33434311224489793.
Trial 25 finished with value: 0.21803252551020408 and parameters: {'lr': 8.199601630757867e-05, 'dropout': 0.15562363808956714, 'patch_size': 32, 'embed_dim': 768, 'depth': 3, 'n_heads': 6, 'mlp_ratio': 2, 'mix_ratio': 0.588251651218385}. Best is trial 24 with value: 0.33434311224489793.
Trial 26 finished with value: 0.12683354591836735 and parameters: {'lr': 3.906999172160915e-05, 'dropout': 0.4877545200925976, 'patch_size': 16, 'embed_dim': 576, 'depth': 3, 'n_heads': 6, 'mlp_ratio': 2, 'mix_ratio': 0.5997123299355867}. Best is trial 24 with value: 0.33434311224489793.
Trial 27 finished with value: 0.21691645408163265 and parameters: {'lr': 3.337863163080862e-05, 'dropout': 0.10111624918276066, 'patch_size': 16, 'embed_dim': 384, 'depth': 3, 'n_heads': 6, 'mlp_ratio': 2, 'mix_ratio': 0.4550240970598443}. Best is trial 24 with value: 0.33434311224489793.
Trial 28 finished with value: 0.2990672831632653 and parameters: {'lr': 5.817517473693791e-05, 'dropout': 0.14848337381239055, 'patch_size': 16, 'embed_dim': 768, 'depth': 4, 'n_heads': 3, 'mlp_ratio': 4, 'mix_ratio': 0.5383342953683933}. Best is trial 24 with value: 0.33434311224489793.
Trial 29 finished with value: 0.13030133928571427 and parameters: {'lr': 9.786564930005063e-05, 'dropout': 0.26601721399004974, 'patch_size': 32, 'embed_dim': 192, 'depth': 2, 'n_heads': 4, 'mlp_ratio': 3, 'mix_ratio': 0.5705087966632949}. Best is trial 24 with value: 0.33434311224489793.
Trial 30 finished with value: 0.29739317602040816 and parameters: {'lr': 0.00033089638889195825, 'dropout': 0.17773682682858144, 'patch_size': 16, 'embed_dim': 576, 'depth': 3, 'n_heads': 6, 'mlp_ratio': 4, 'mix_ratio': 0.21198902753179394}. Best is trial 24 with value: 0.33434311224489793.
Trial 31 finished with value: 0.314453125 and parameters: {'lr': 0.0001491013889429961, 'dropout': 0.12019517906520485, 'patch_size': 16, 'embed_dim': 768, 'depth': 2, 'n_heads': 6, 'mlp_ratio': 2, 'mix_ratio': 0.5641083762521614}. Best is trial 24 with value: 0.33434311224489793.
Trial 32 finished with value: 0.32704878826530615 and parameters: {'lr': 0.0001592307950343702, 'dropout': 0.1225736568882458, 'patch_size': 16, 'embed_dim': 768, 'depth': 2, 'n_heads': 6, 'mlp_ratio': 2, 'mix_ratio': 0.5352025701423443}. Best is trial 24 with value: 0.33434311224489793.
Trial 33 finished with value: 0.3088329081632653 and parameters: {'lr': 9.250591756807512e-05, 'dropout': 0.13223354349252253, 'patch_size': 16, 'embed_dim': 768, 'depth': 2, 'n_heads': 6, 'mlp_ratio': 2, 'mix_ratio': 0.5239569693740791}. Best is trial 24 with value: 0.33434311224489793.
Trial 34 finished with value: 0.27084661989795916 and parameters: {'lr': 0.0002237056782112539, 'dropout': 0.20169203876404226, 'patch_size': 16, 'embed_dim': 768, 'depth': 6, 'n_heads': 6, 'mlp_ratio': 2, 'mix_ratio': 0.49401844328441363}. Best is trial 24 with value: 0.33434311224489793.
Trial 35 finished with value: 0.29005899234693877 and parameters: {'lr': 0.00011512498416165047, 'dropout': 0.15043256993422793, 'patch_size': 8, 'embed_dim': 384, 'depth': 2, 'n_heads': 3, 'mlp_ratio': 2, 'mix_ratio': 0.4966151356118824}. Best is trial 24 with value: 0.33434311224489793.
Trial 36 finished with value: 0.30106026785714285 and parameters: {'lr': 0.00018334966169441996, 'dropout': 0.11730471626516015, 'patch_size': 16, 'embed_dim': 768, 'depth': 2, 'n_heads': 4, 'mlp_ratio': 2, 'mix_ratio': 0.5420808211968702}. Best is trial 24 with value: 0.33434311224489793.
Trial 37 finished with value: 0.30600286989795916 and parameters: {'lr': 6.447390070524053e-05, 'dropout': 0.22202623597764848, 'patch_size': 8, 'embed_dim': 768, 'depth': 3, 'n_heads': 6, 'mlp_ratio': 2, 'mix_ratio': 0.2989095966411787}. Best is trial 24 with value: 0.33434311224489793.
Trial 38 finished with value: 0.17964764030612246 and parameters: {'lr': 2.4455730580523032e-05, 'dropout': 0.18202520493530405, 'patch_size': 16, 'embed_dim': 384, 'depth': 5, 'n_heads': 2, 'mlp_ratio': 3, 'mix_ratio': 0.5802184962094727}. Best is trial 24 with value: 0.33434311224489793.
Trial 39 finished with value: 0.2643893494897959 and parameters: {'lr': 0.000430199043636507, 'dropout': 0.25323623874898005, 'patch_size': 8, 'embed_dim': 192, 'depth': 4, 'n_heads': 6, 'mlp_ratio': 2, 'mix_ratio': 0.4219359929400605}. Best is trial 24 with value: 0.33434311224489793.
Trial 40 finished with value: 0.23588966836734693 and parameters: {'lr': 0.0002673357091187012, 'dropout': 0.328203467560128, 'patch_size': 16, 'embed_dim': 768, 'depth': 4, 'n_heads': 4, 'mlp_ratio': 2, 'mix_ratio': 0.47945484783164927}. Best is trial 24 with value: 0.33434311224489793.
Trial 41 finished with value: 0.30759725765306123 and parameters: {'lr': 0.00016126572508791311, 'dropout': 0.11857384346978378, 'patch_size': 16, 'embed_dim': 768, 'depth': 2, 'n_heads': 6, 'mlp_ratio': 2, 'mix_ratio': 0.5549132906142719}. Best is trial 24 with value: 0.33434311224489793.
Trial 42 finished with value: 0.32334183673469385 and parameters: {'lr': 0.00014047509783907794, 'dropout': 0.10094978224506818, 'patch_size': 16, 'embed_dim': 768, 'depth': 2, 'n_heads': 6, 'mlp_ratio': 2, 'mix_ratio': 0.5764830926980674}. Best is trial 24 with value: 0.33434311224489793.
Trial 43 finished with value: 0.21986607142857142 and parameters: {'lr': 0.00011118040138952721, 'dropout': 0.40878953214349906, 'patch_size': 16, 'embed_dim': 768, 'depth': 2, 'n_heads': 6, 'mlp_ratio': 2, 'mix_ratio': 0.5999417362341198}. Best is trial 24 with value: 0.33434311224489793.
Trial 44 finished with value: 0.25027901785714285 and parameters: {'lr': 8.44379721757084e-05, 'dropout': 0.10138347164330618, 'patch_size': 16, 'embed_dim': 768, 'depth': 2, 'n_heads': 2, 'mlp_ratio': 2, 'mix_ratio': 0.5779717606009718}. Best is trial 24 with value: 0.33434311224489793.
Trial 45 finished with value: 0.29555963010204084 and parameters: {'lr': 0.00013758379537251548, 'dropout': 0.15796923091160395, 'patch_size': 16, 'embed_dim': 768, 'depth': 3, 'n_heads': 3, 'mlp_ratio': 3, 'mix_ratio': 0.3834385790116738}. Best is trial 24 with value: 0.33434311224489793.
Trial 46 finished with value: 0.23003029336734693 and parameters: {'lr': 0.0001861779880023812, 'dropout': 0.13624879550439412, 'patch_size': 16, 'embed_dim': 192, 'depth': 2, 'n_heads': 6, 'mlp_ratio': 2, 'mix_ratio': 0.518217206187642}. Best is trial 24 with value: 0.33434311224489793.
Trial 47 finished with value: 0.24131058673469388 and parameters: {'lr': 0.00027412041422154886, 'dropout': 0.11750164911008186, 'patch_size': 32, 'embed_dim': 576, 'depth': 3, 'n_heads': 6, 'mlp_ratio': 2, 'mix_ratio': 0.5344270422620466}. Best is trial 24 with value: 0.33434311224489793.
Trial 48 finished with value: 0.299625318877551 and parameters: {'lr': 4.7311247341869664e-05, 'dropout': 0.16871546555020644, 'patch_size': 8, 'embed_dim': 768, 'depth': 2, 'n_heads': 6, 'mlp_ratio': 4, 'mix_ratio': 0.5831929715627194}. Best is trial 24 with value: 0.33434311224489793.
Trial 49 finished with value: 0.18080357142857142 and parameters: {'lr': 1.0070447111486247e-05, 'dropout': 0.14273965337644456, 'patch_size': 16, 'embed_dim': 768, 'depth': 5, 'n_heads': 6, 'mlp_ratio': 2, 'mix_ratio': 0.5492574481907565}. Best is trial 24 with value: 0.33434311224489793.
A new study created in memory with name: no-name-22aebd68-3f15-4f4d-9df3-584e57892603
Trial 0 finished with values: [0.13301179846938777, 0.25302243002637814] and parameters: {'lr': 2.4273885912420093e-05, 'dropout': 0.36608580410066627, 'patch_size': 8, 'embed_dim': 576, 'depth': 2, 'n_heads': 4, 'mlp_ratio': 3, 'mix_ratio': 0.5634204221842853, 'weight_decay': 0.0024454606913750505}.
Trial 1 finished with values: [0.23899872448979592, 0.46427024426818164] and parameters: {'lr': 7.404417927985901e-05, 'dropout': 0.2589667554648962, 'patch_size': 16, 'embed_dim': 384, 'depth': 6, 'n_heads': 3, 'mlp_ratio': 4, 'mix_ratio': 0.5408535647612867, 'weight_decay': 0.0009533044458962207}.
Trial 2 finished with values: [0.20958227040816327, 0.3983075834359733] and parameters: {'lr': 7.792835184404194e-05, 'dropout': 0.4449385747886416, 'patch_size': 16, 'embed_dim': 576, 'depth': 4, 'n_heads': 8, 'mlp_ratio': 3, 'mix_ratio': 0.4786407451215177, 'weight_decay': 0.004467038018587947}.
Trial 3 finished with values: [0.26072225765306123, 0.5015759393608885] and parameters: {'lr': 0.0006019041250416913, 'dropout': 0.34069667596265535, 'patch_size': 8, 'embed_dim': 384, 'depth': 3, 'n_heads': 4, 'mlp_ratio': 4, 'mix_ratio': 0.5288517879477319, 'weight_decay': 0.00037738568717781036}.
Trial 4 finished with values: [0.2325015943877551, 0.46758172015589583] and parameters: {'lr': 0.00010215529274637699, 'dropout': 0.3534095556778589, 'patch_size': 16, 'embed_dim': 576, 'depth': 4, 'n_heads': 2, 'mlp_ratio': 4, 'mix_ratio': 0.5320127795937643, 'weight_decay': 0.0001162995229672101}.
Trial 5 finished with values: [0.06497130102040816, 0.06536588129474374] and parameters: {'lr': 3.868275686123734e-05, 'dropout': 0.49121303081611767, 'patch_size': 16, 'embed_dim': 192, 'depth': 4, 'n_heads': 4, 'mlp_ratio': 3, 'mix_ratio': 0.22406188805364083, 'weight_decay': 0.0001108304657190741}.
Trial 6 finished with values: [0.2382015306122449, 0.38229232681783065] and parameters: {'lr': 0.00028770281483463784, 'dropout': 0.32821702680360554, 'patch_size': 16, 'embed_dim': 768, 'depth': 4, 'n_heads': 3, 'mlp_ratio': 4, 'mix_ratio': 0.33853884389244504, 'weight_decay': 0.0030083082938558705}.
Trial 7 finished with values: [0.17004145408163265, 0.24154047941674994] and parameters: {'lr': 1.998470714651192e-05, 'dropout': 0.2282546645023872, 'patch_size': 16, 'embed_dim': 384, 'depth': 6, 'n_heads': 4, 'mlp_ratio': 3, 'mix_ratio': 0.27197016025896026, 'weight_decay': 0.023428612145372826}.
Trial 8 finished with values: [0.220703125, 0.37502497341425833] and parameters: {'lr': 9.348003037541314e-05, 'dropout': 0.3207694887444372, 'patch_size': 8, 'embed_dim': 384, 'depth': 5, 'n_heads': 3, 'mlp_ratio': 3, 'mix_ratio': 0.4751873956549333, 'weight_decay': 0.005967196611861579}.
Trial 9 finished with values: [0.2089046556122449, 0.3526079949026326] and parameters: {'lr': 0.00018618608673086822, 'dropout': 0.43238759280187133, 'patch_size': 8, 'embed_dim': 576, 'depth': 4, 'n_heads': 2, 'mlp_ratio': 4, 'mix_ratio': 0.5770665561700812, 'weight_decay': 0.00027084147662609977}.
Trial 10 finished with values: [0.009964923469387755, 0.006039095205322198] and parameters: {'lr': 0.0006665119449273478, 'dropout': 0.1655033829070886, 'patch_size': 8, 'embed_dim': 768, 'depth': 6, 'n_heads': 2, 'mlp_ratio': 3, 'mix_ratio': 0.39644431020377, 'weight_decay': 0.009757959072524703}.
Trial 11 failed with parameters: {'lr': 0.0007357265897176271, 'dropout': 0.2939054156105083, 'patch_size': 8, 'embed_dim': 576, 'depth': 4, 'n_heads': 12, 'mlp_ratio': 4, 'mix_ratio': 0.3074286113942311, 'weight_decay': 0.014176637113390957} because of the following error: OutOfMemoryError('CUDA out of memory. Tried to allocate 7.05 GiB. GPU 0 has a total capacity of 79.14 GiB of which 4.56 GiB is free. Process 4189135 has 74.56 GiB memory in use. Of the allocated memory 66.66 GiB is allocated by PyTorch, and 7.39 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)').
Traceback (most recent call last):
  File "/ai/mount/stxyx/miniconda3/envs/py3810/lib/python3.8/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
  File "Vit_optuna_v2.py", line 244, in objective
    loss.backward()
  File "/ai/mount/stxyx/miniconda3/envs/py3810/lib/python3.8/site-packages/torch/_tensor.py", line 521, in backward
    torch.autograd.backward(
  File "/ai/mount/stxyx/miniconda3/envs/py3810/lib/python3.8/site-packages/torch/autograd/__init__.py", line 289, in backward
    _engine_run_backward(
  File "/ai/mount/stxyx/miniconda3/envs/py3810/lib/python3.8/site-packages/torch/autograd/graph.py", line 769, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 7.05 GiB. GPU 0 has a total capacity of 79.14 GiB of which 4.56 GiB is free. Process 4189135 has 74.56 GiB memory in use. Of the allocated memory 66.66 GiB is allocated by PyTorch, and 7.39 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Trial 11 failed with value None.
A new study created in memory with name: no-name-c99c1fb0-85c9-4f61-ada1-40d52191430e
Trial 0 finished with values: [0.2423469387755102, 0.43688226323439494] and parameters: {'lr': 4.392505428050167e-05, 'dropout': 0.1960943641714299, 'patch_size': 16, 'embed_dim': 576, 'depth': 4, 'n_heads': 2, 'mlp_ratio': 3, 'mix_ratio': 0.5783447259670496, 'weight_decay': 0.0001230609221768214}.
Trial 1 finished with values: [0.054009885204081634, 0.09512154592522659] and parameters: {'lr': 0.0006706915297199276, 'dropout': 0.38231449222659153, 'patch_size': 8, 'embed_dim': 768, 'depth': 5, 'n_heads': 3, 'mlp_ratio': 4, 'mix_ratio': 0.4462748688355872, 'weight_decay': 0.004138015422945446}.
Trial 2 finished with values: [0.2598453443877551, 0.454035086150979] and parameters: {'lr': 6.803048107028334e-05, 'dropout': 0.3555118590459363, 'patch_size': 8, 'embed_dim': 768, 'depth': 3, 'n_heads': 4, 'mlp_ratio': 2, 'mix_ratio': 0.572982713041913, 'weight_decay': 0.0021395320780174054}.
Trial 3 finished with values: [0.09897161989795919, 0.09325406648674761] and parameters: {'lr': 1.912629084853302e-05, 'dropout': 0.3114099452367127, 'patch_size': 8, 'embed_dim': 384, 'depth': 4, 'n_heads': 2, 'mlp_ratio': 4, 'mix_ratio': 0.23439349791893666, 'weight_decay': 0.0016242183339116492}.
Trial 4 failed with parameters: {'lr': 0.00015285720057390157, 'dropout': 0.2500510342241631, 'patch_size': 8, 'embed_dim': 192, 'depth': 3, 'n_heads': 3, 'mlp_ratio': 3, 'mix_ratio': 0.2242879249040009, 'weight_decay': 0.00489953914044114} because of the following error: KeyboardInterrupt().
Traceback (most recent call last):
  File "/ai/mount/stxyx/miniconda3/envs/py3810/lib/python3.8/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
  File "Vit_optuna_v2.py", line 237, in objective
    for img, target in train_loader:
  File "/ai/mount/stxyx/miniconda3/envs/py3810/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/ai/mount/stxyx/miniconda3/envs/py3810/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1327, in _next_data
    idx, data = self._get_data()
  File "/ai/mount/stxyx/miniconda3/envs/py3810/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1283, in _get_data
    success, data = self._try_get_data()
  File "/ai/mount/stxyx/miniconda3/envs/py3810/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1131, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/ai/mount/stxyx/miniconda3/envs/py3810/lib/python3.8/queue.py", line 179, in get
    self.not_empty.wait(remaining)
  File "/ai/mount/stxyx/miniconda3/envs/py3810/lib/python3.8/threading.py", line 306, in wait
    gotit = waiter.acquire(True, timeout)
KeyboardInterrupt
Trial 4 failed with value None.
